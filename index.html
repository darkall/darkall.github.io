<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Open Graph 元标签（兜底用） -->
    <meta property="og:title" content="中新网评：数字浪潮激荡正能量 云端聚力领航主旋律">
    <meta property="og:description" content="2024中国正能量网络精品征集展播活动记录高光时刻，呈现大国崛起精神图谱">
    <meta property="og:image" content="https://cdn.prod.website-files.com/65943d23dc44e6ce92eb6b67/65fb2de06abe3639bac78923_renter_listing_search-p-800.png" />
	<meta property="og:url" content="https://darkall.github.io" />
    
    <!-- 微信 JS-SDK -->
    <script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>
    <title>新闻测试页</title>
    
    <style>
        .content-article {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
        }
        h1 { font-size: 24px; line-height: 1.5; }
        .share-button { text-align: center; margin: 30px 0; }
        .share-button button { padding: 10px 20px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>

	<button onclick="launchWechat()">打开微信添加好友</button>

  <script>
    function launchWechat() {
      // 微信添加好友协议（示例：微信号为 test123）
      const wechatUrl = 'weixin://dl/add?username=test123'; 

      // 尝试调起微信
      window.location.href = wechatUrl;

      // 兼容性处理：若调起失败，跳转微信下载页
      setTimeout(() => {
        if (!document.hidden) {
          window.location.href = 'https://weixin.qq.com/';
        }
      }, 2000);
    }
  </script>
	
    <div class="content-article">
        <h1>中新网评：数字浪潮激荡正能量 云端聚力领航主旋律</h1>
        <div class="article-author">
            <img src="https://inews.gtimg.com/newsapp_bt/0/1128164013310_1586/0" alt="中国新闻网" style="width:36px;height:36px;border-radius:50%;margin-right:10px;">
            <div>
                <p style="margin:0;font-weight:bold;">中国新闻网</p>
                <p style="margin:0;color:#666;">2025-03-02 09:18 发布于北京</p>
            </div>
        </div>
        
        <!-- 正文内容（示例节选） -->
        <div class="rich_media_content">
            <p>由中央网信办主办的2024中国正能量网络精品征集展播活动正稳步开展。活动以“改革开新局 奋斗创伟业”为主题，通过多元形式记录高光时刻、精彩瞬间...</p>
            <img src="https://inews.gtimg.com/om_bt/OeMcnleEyEQh7CMt8t4ny33AUJWrOAXrcj0FLn-CrL4rsAA/641" alt="新闻配图" style="width:100%;border-radius:8px;">
        </div>
        
        <!-- 替换二维码为按钮 -->
        <div class="share-button">
            <button id="shareToFriend">分享给朋友</button>
            <button id="shareToTimeline">分享到朋友圈</button>
        </div>
    </div>

    <script>
        // 微信 JS-SDK 配置（需后端生成签名）
        wx.config({
            debug: true, // 开启调试模式，便于查看错误信息
            appId: 'YOUR_APP_ID', // 替换为你的公众号AppID
            timestamp: 1710000000, // 后端生成的时间戳（秒级）
            nonceStr: 'YOUR_NONCE_STR', // 后端生成的随机串
            signature: 'YOUR_SIGNATURE', // 后端计算的签名
            jsApiList: ['updateAppMessageShareData', 'updateTimelineShareData']
        });

        // 初始化配置完成回调
        wx.ready(() => {
            console.log('微信 SDK 初始化成功');

            document.getElementById('shareToFriend').addEventListener('click', () => {
                console.log('用户点击了“分享给朋友”按钮');
                wx.updateAppMessageShareData({
                    title: '分享标题：数字浪潮激荡正能量', // 覆盖 og:title
                    desc: '分享描述：点击查看2024中国正能量网络精品展播', // 覆盖 og:description
                    link: window.location.href,
                    imgUrl: 'https://inews.gtimg.com/om_bt/OeMcnleEyEQh7CMt8t4ny33AUJWrOAXrcj0FLn-CrL4rsAA/641',
                    success: function () {
                        console.log('成功调起微信分享给朋友');
                        alert('已成功调起微信分享给朋友');
                    },
                    fail: function (res) {
                        console.error('分享给朋友失败:', res);
                        alert('分享给朋友失败，请手动复制链接');
                    }
                });
            });

            document.getElementById('shareToTimeline').addEventListener('click', () => {
                console.log('用户点击了“分享到朋友圈”按钮');
                wx.updateTimelineShareData({
                    title: '朋友圈标题：数字浪潮领航主旋律', // 朋友圈只显示标题
                    link: window.location.href,
                    imgUrl: 'https://inews.gtimg.com/om_bt/OeMcnleEyEQh7CMt8t4ny33AUJWrOAXrcj0FLn-CrL4rsAA/641',
                    success: function () {
                        console.log('成功调起微信分享到朋友圈');
                        alert('已成功调起微信分享到朋友圈');
                    },
                    fail: function (res) {
                        console.error('分享到朋友圈失败:', res);
                        alert('分享到朋友圈失败，请手动复制链接');
                    }
                });
            });
        });

        // 错误处理
        wx.error(function(res) {
            console.error('微信 SDK 初始化失败:', res);
            alert('分享功能暂不可用，请手动复制链接');
        });
    </script>
</body>
</html>
